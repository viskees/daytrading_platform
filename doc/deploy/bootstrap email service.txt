# Start mailserver + stack
docker compose --env-file .env.prod -f docker-compose.prod.yml up -d --build

# Add mailbox --> heeft Django nodig om te kunnen aanmelden op de mailserver
docker exec -it mailserver setup email add no-reply@trade-journal.nl "giffaH-mupfuh-zyvwi8"

# Add alias
docker exec -it mailserver setup alias add alerts@trade-journal.nl viskees@gmail.com

# List accounts
docker exec -it mailserver setup email list

# List aliases
docker exec -it mailserver setup alias list

# Generate DKIM (one-time)
docker exec -it mailserver setup config dkim

# Mailserver logs
docker logs mailserver --tail=200

# Queue
docker exec -it mailserver postqueue -p
docker exec -it mailserver postfix flush

# Test
docker compose --env-file .env.prod -f docker-compose.prod.yml exec django bash

cd /app/app
python manage.py shell

from django.core.mail import send_mail
send_mail(
    "Test from Trade Journal",
    "SMTP OK!",
    None,
    ["alerts@trade-journal.nl"],
)

# Firewall
ALLOW TCP 25
ALLOW TCP 587
ALLOW TCP 80
ALLOW TCP 443